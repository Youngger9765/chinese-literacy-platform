# MVP è¨­è¨ˆ - åœ‹èªæ–‡æœ—è®€å­¸ç¿’å¹³å° (æ­£ç¢ºç‰ˆ)

> **å°ˆæ¡ˆ**: åœ‹èªæ–‡æœ—è®€å­¸ç¿’å¹³å° (æ–¹å¤§å“¥)
>
> **è¨­è¨ˆæ—¥æœŸ**: 2026-02-13
>
> **æ ¸å¿ƒç†å¿µ**: AI èªéŸ³åˆ†æ + å³æ™‚å›é¥‹,å”åŠ©æ•™å¸«ç²¾æº–æŒæ¡å­¸ç”Ÿé–±è®€æµæš¢åº¦

---

## âŒ ä¹‹å‰çš„éŒ¯èª¤

### éŒ¯èª¤çš„ MVP (å·²å»¢æ£„)

ä¹‹å‰çš„ `MVP-è¨­è¨ˆ.md` **å®Œå…¨èª¤è§£éœ€æ±‚**:

| é …ç›® | éŒ¯èª¤ç‰ˆæœ¬ | æ­£ç¢ºéœ€æ±‚ |
|------|---------|---------|
| **æ ¸å¿ƒåŠŸèƒ½** | âŒ æ•™å¸«æ‰‹å‹•æ‰¹æ”¹ | âœ… **AI è‡ªå‹•åˆ†æèªéŸ³** |
| **å›é¥‹é€Ÿåº¦** | âŒ å»¶é²æ‰¹æ”¹ | âœ… **< 5 ç§’å³æ™‚å›é¥‹** |
| **åˆ†æå…§å®¹** | âŒ ç„¡ | âœ… èªé€Ÿã€æ­£ç¢ºç‡ã€é€å¥å°æ¯”ã€éŒ¯å­—è©æ¸…å–® |
| **æ•™å­¸ç†è«–** | âŒ ç„¡ | âœ… æ›¾ä¸–æ°æ•™æˆé–±è®€ç§‘å­¸ |
| **åƒè€ƒå¯¦ä½œ** | âŒ ç„¡ | âœ… æ–¹å¤§å“¥ Flutter App (9,606 å­—ç­†é †) |

**å•é¡Œæ ¹æº**: çœ‹åˆ°ã€Œç°¡åŒ–ã€å°±æƒ³åšé›¶ç¨‹å¼ç¢¼æ–¹æ¡ˆ,å¿½ç•¥äº†ç”¢å“çš„æ ¸å¿ƒåƒ¹å€¼æ˜¯ **AI èªéŸ³åˆ†æ**ã€‚

---

## ğŸ¯ æ­£ç¢ºçš„ MVP å®šç¾©

### æ ¸å¿ƒåƒ¹å€¼ä¸»å¼µ

**ç”¨ AI æŠ€è¡“è‡ªå‹•åŒ–åˆ†æå­¸ç”Ÿçš„åœ‹èªæ–‡æœ—è®€è¡¨ç¾,å”åŠ©æ•™å¸«ç²¾æº–æŒæ¡æ¯ä½å­¸ç”Ÿçš„é–±è®€æµæš¢åº¦,å¯¦ç¾å€‹åˆ¥åŒ–æ•™å­¸ã€‚**

### é—œéµç‰¹å¾µ

1. **AI èªéŸ³åˆ†æ** - ä¸æ˜¯äººå·¥æ‰¹æ”¹!
2. **å³æ™‚å›é¥‹** - < 5 ç§’,ä¸æ˜¯å¹¾å¤©å¾Œ!
3. **ç§‘å­¸åŒ–è©•ä¼°** - èªé€Ÿ Ã— æ­£ç¢ºç‡,ä¸æ˜¯ä¸»è§€æ„Ÿè¦º!
4. **å€‹åˆ¥åŒ–æ•™å­¸** - æ¯å€‹å­¸ç”Ÿå°ˆå±¬å­¸ç¿’è·¯å¾‘

---

## ğŸ“‹ P0 åŠŸèƒ½æ¸…å–® (MVP å¿…è¦)

### æ•™å¸«ç«¯

- [ ] æ•™å¸«è¨»å†Š/ç™»å…¥ (Google/Microsoft SSO)
- [ ] Email ç¶²åŸŸé©—è­‰ (ç¢ºèªæ˜¯å­¸æ ¡æ•™å¸«)
- [ ] åŒæ„ä½¿ç”¨æ¢æ¬¾ (4 é …è‘—ä½œæ¬ŠåŒæ„)
- [ ] å»ºç«‹å­¸æ ¡
- [ ] å»ºç«‹ç­ç´š
- [ ] å»ºç«‹å­¸ç”Ÿåå–® (CSV åŒ¯å…¥)
- [ ] **ä¸Šå‚³èª²æ–‡** (æ–‡å­—è²¼ä¸Š)
- [ ] **è¨­å®šèª²æ–‡ç›®æ¨™** (èªé€Ÿã€æ­£ç¢ºç‡)
- [ ] æŸ¥çœ‹å­¸ç”Ÿæœ—è®€ç´€éŒ„
- [ ] æŸ¥çœ‹ç­ç´šçµ±è¨ˆå ±å‘Š
- [ ] æŸ¥çœ‹å­¸ç”Ÿå€‹åˆ¥å ±å‘Š

### å­¸ç”Ÿç«¯ (æ ¸å¿ƒåŠŸèƒ½)

- [ ] å­¸ç”Ÿç™»å…¥
- [ ] æŸ¥çœ‹åˆ†é…çš„èª²æ–‡åˆ—è¡¨
- [ ] **æ³¨éŸ³ç¬¦è™Ÿé¡¯ç¤ºåˆ‡æ›** (Space å¿«æ·éµ)
- [ ] **åˆ†æ®µæœ—è®€æµç¨‹**:
  - [ ] å…ˆæœ—è®€æ®µè½ (æ¯æ®µç¨ç«‹ç·´ç¿’)
  - [ ] æ¯æ®µé”æ¨™å¾Œè§£é–ä¸‹ä¸€æ®µ
  - [ ] æ‰€æœ‰æ®µè½å®Œæˆå¾Œæœ—è®€æ•´ç¯‡
  - [ ] éŒ„éŸ³åŠŸèƒ½ (æ¯æ®µç¨ç«‹éŒ„éŸ³)
- [ ] **å³æ™‚å›é¥‹å…­å¤§ç’°ç¯€** â­ æ ¸å¿ƒ!
  1. **æœ—è®€çµæœç¸½è¦½** (èªé€Ÿã€æ­£ç¢ºç‡ã€æ˜¯å¦é”æ¨™)
  2. **éŒ„éŸ³æ’­æ”¾èˆ‡è½‰éŒ„** (è½è‡ªå·±çš„è²éŸ³ + AI è½‰éŒ„æ–‡å­—)
  3. **é€å¥åˆ†æå°æ¯”** (åŸæ–‡ vs å¯¦è®€,ç´…è‰²æ¨™è¨»éŒ¯èª¤)
  4. **éŒ¯å­—è©ç·´ç¿’æ¸…å–®** (è‡ªå‹•å½™æ•´è®€éŒ¯çš„å­—,å«ğŸ”Šç™¼éŸ³æŒ‰éˆ•)
  5. **ç·´ç¿’å»ºè­°** (AI çµ¦äºˆæ”¹é€²å»ºè­°)
  6. **AI è©³ç´°åˆ†æ** (è·³å­—ã€åŠ å­—ã€è®€éŒ¯åˆ†é¡)
- [ ] çµ±è¨ˆå ±å‘Š (å€‹äººå­¸ç¿’æ›²ç·š)
- [ ] ç·´ç¿’ç´€éŒ„æŸ¥è©¢

### æ ¸å¿ƒæŠ€è¡“ â­ æœ€é‡è¦!

- [ ] **Azure Speech SDK ç¹é«”ä¸­æ–‡èªéŸ³è­˜åˆ¥** (zh-TW)
- [ ] **æœ—è®€æµæš¢åº¦åˆ†æ** (èªé€Ÿã€æ­£ç¢ºç‡)
- [ ] **éŒ¯èª¤åµæ¸¬èˆ‡åˆ†é¡** (è·³å­—ã€åŠ å­—ã€è®€éŒ¯)
- [ ] **æ–‡æœ¬æ¯”å°æ¼”ç®—æ³•** (Levenshtein Distance + ä¸­æ–‡å­—å°é½Š)

---

## ğŸ—ï¸ æŠ€è¡“æ¶æ§‹

### æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å­¸ç”Ÿç«¯ (React) â”‚
â”‚  - çœ‹èª²æ–‡       â”‚
â”‚  - éŒ„éŸ³ä¸Šå‚³     â”‚
â”‚  - å³æ™‚å›é¥‹     â”‚ â† Space éµåˆ‡æ›æ³¨éŸ³
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚ HTTPS
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å¾Œç«¯ API (NestJS)    â”‚
â”‚  /lessons              â”‚
â”‚  /submissions          â”‚
â”‚  /speech/analyze â­    â”‚ â† æ ¸å¿ƒ API!
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€> PostgreSQL (èª²ç¨‹ + ä½œæ¥­ + åˆ†æçµæœ)
         â”œâ”€â”€> Cloud Storage (éŸ³æª”)
         â”œâ”€â”€> Azure Speech SDK â­ (èªéŸ³è½‰æ–‡å­—)
         â””â”€â”€> GitHub (èª²ç¨‹ Markdown)
```

### æŠ€è¡“é¸å‹

| å±¤ç´š | æŠ€è¡“ | åŸå›  |
|------|------|------|
| å‰ç«¯ | **Next.js 14 + TypeScript** | PRD æŒ‡å®š |
| å¾Œç«¯ | **NestJS + PostgreSQL** | PRD æŒ‡å®š |
| èªéŸ³è­˜åˆ¥ | **Azure Speech SDK (zh-TW)** â­ | PRD æŒ‡å®š,æ’åå‰ 2 |
| é›²ç«¯ | **GCP** | Cloud Run + Cloud SQL + Cloud Storage |
| èª²ç¨‹ | **GitHub (Markdown)** | ç‰ˆæœ¬æ§åˆ¶ + å…è²» |

---

## ğŸ¤ æ ¸å¿ƒåŠŸèƒ½: AI èªéŸ³åˆ†ææµç¨‹

### 1. å­¸ç”ŸéŒ„éŸ³

```typescript
// AudioRecorder.tsx
export function AudioRecorder({ lessonId, paragraph }: Props) {
  const [isRecording, setIsRecording] = useState(false);
  const [audioBlob, setAudioBlob] = useState<Blob | null>(null);

  const startRecording = async () => {
    const stream = await navigator.mediaDevices.getUserMedia({ audio: true });
    const mediaRecorder = new MediaRecorder(stream);

    mediaRecorder.ondataavailable = (e) => {
      setAudioBlob(e.data);
    };

    mediaRecorder.start();
    setIsRecording(true);
  };

  const submitRecording = async () => {
    const formData = new FormData();
    formData.append('audio', audioBlob, 'recording.webm');
    formData.append('lessonId', lessonId);
    formData.append('paragraph', paragraph);

    // ä¸Šå‚³ + åˆ†æ (ä¸€æ¬¡ API å‘¼å«)
    const result = await api.speech.analyze(formData);

    // é¡¯ç¤ºå…­å¤§ç’°ç¯€å›é¥‹
    showFeedback(result);
  };

  return (
    <div>
      <button onClick={isRecording ? stopRecording : startRecording}>
        {isRecording ? 'åœæ­¢éŒ„éŸ³' : 'é–‹å§‹éŒ„éŸ³'}
      </button>
      {audioBlob && <button onClick={submitRecording}>æäº¤</button>}
    </div>
  );
}
```

### 2. å¾Œç«¯ AI åˆ†æ (æ ¸å¿ƒé‚è¼¯)

```typescript
// speech-analysis.service.ts

@Injectable()
export class SpeechAnalysisService {
  constructor(
    private azureSpeech: AzureSpeechService,
    private prisma: PrismaService,
  ) {}

  async analyzeRecording(
    audioFile: Express.Multer.File,
    lessonId: string,
    paragraph: number,
  ): Promise<FeedbackResult> {

    // 1. å–å¾—åŸæ–‡
    const lesson = await this.prisma.lesson.findUnique({
      where: { id: lessonId },
    });
    const originalText = this.extractParagraph(lesson.content, paragraph);

    // 2. ä¸Šå‚³éŸ³æª”åˆ° Cloud Storage
    const audioUrl = await this.uploadAudio(audioFile);

    // 3. Azure Speech SDK èªéŸ³è½‰æ–‡å­—
    const transcription = await this.azureSpeech.recognizeFromFile(
      audioFile.buffer,
      { locale: 'zh-TW' }
    );

    // 4. æ–‡æœ¬æ¯”å°åˆ†æ
    const analysis = this.compareTexts(originalText, transcription.text);

    // 5. è¨ˆç®—æµæš¢åº¦æŒ‡æ¨™
    const metrics = this.calculateMetrics(
      transcription,
      analysis,
      originalText
    );

    // 6. éŒ¯èª¤åˆ†é¡
    const errors = this.classifyErrors(analysis);

    // 7. ç”Ÿæˆç·´ç¿’å»ºè­°
    const suggestions = this.generateSuggestions(metrics, errors);

    // 8. å„²å­˜çµæœ
    await this.prisma.submission.create({
      data: {
        student_id: studentId,
        lesson_id: lessonId,
        paragraph,
        audio_url: audioUrl,
        transcription: transcription.text,
        original_text: originalText,
        speed_wpm: metrics.speed,
        accuracy_rate: metrics.accuracy,
        errors: errors,
        suggestions: suggestions,
        is_passed: metrics.accuracy >= 90 && metrics.speed >= 150,
      },
    });

    // 9. å›å‚³å…­å¤§ç’°ç¯€è³‡æ–™
    return {
      overview: {
        speed: metrics.speed,
        accuracy: metrics.accuracy,
        isPassed: metrics.accuracy >= 90 && metrics.speed >= 150,
      },
      recording: {
        audioUrl,
        transcription: transcription.text,
      },
      sentenceComparison: analysis.sentences,
      errorWordsList: errors,
      suggestions,
      aiAnalysis: this.generateAIAnalysis(metrics, errors),
    };
  }

  // æ–‡æœ¬æ¯”å°æ¼”ç®—æ³•
  private compareTexts(original: string, transcribed: string) {
    // ä½¿ç”¨ Levenshtein Distance + ä¸­æ–‡åˆ†è©
    const originalChars = Array.from(original);
    const transcribedChars = Array.from(transcribed);

    const alignment = this.alignTexts(originalChars, transcribedChars);

    return {
      sentences: this.splitIntoSentences(alignment),
      totalErrors: alignment.filter(a => a.type !== 'match').length,
      alignment,
    };
  }

  // è¨ˆç®—æµæš¢åº¦æŒ‡æ¨™
  private calculateMetrics(transcription, analysis, originalText) {
    const duration = transcription.duration; // Azure æä¾›
    const wordCount = Array.from(originalText).length;
    const correctWords = wordCount - analysis.totalErrors;

    return {
      speed: Math.round((wordCount / duration) * 60), // å­—/åˆ†
      accuracy: Math.round((correctWords / wordCount) * 100), // %
      duration,
    };
  }

  // éŒ¯èª¤åˆ†é¡
  private classifyErrors(analysis) {
    return analysis.alignment
      .filter(a => a.type !== 'match')
      .map(a => ({
        type: a.type, // 'omission' | 'insertion' | 'substitution'
        original: a.original,
        transcribed: a.transcribed,
        position: a.position,
      }));
  }

  // ç”Ÿæˆç·´ç¿’å»ºè­°
  private generateSuggestions(metrics, errors) {
    const suggestions = [];

    if (metrics.speed < 150) {
      suggestions.push({
        type: 'speed',
        message: 'å»ºè­°å¤šç·´ç¿’æµæš¢æœ—è®€,ç›®æ¨™é€Ÿåº¦ 150 å­—/åˆ†',
      });
    }

    if (metrics.accuracy < 90) {
      suggestions.push({
        type: 'accuracy',
        message: 'å»ºè­°ä»”ç´°çœ‹æ¸…æ¥šæ¯å€‹å­—å†æœ—è®€',
      });
    }

    // é«˜é »éŒ¯å­—æé†’
    const frequentErrors = this.getFrequentErrors(errors);
    if (frequentErrors.length > 0) {
      suggestions.push({
        type: 'frequent_errors',
        message: `é€™äº›å­—éœ€è¦ç‰¹åˆ¥æ³¨æ„: ${frequentErrors.join('ã€')}`,
        words: frequentErrors,
      });
    }

    return suggestions;
  }
}
```

### 3. Azure Speech SDK æ•´åˆ

```typescript
// azure-speech.service.ts

import * as sdk from 'microsoft-cognitiveservices-speech-sdk';

@Injectable()
export class AzureSpeechService {
  private speechConfig: sdk.SpeechConfig;

  constructor() {
    this.speechConfig = sdk.SpeechConfig.fromSubscription(
      process.env.AZURE_SPEECH_KEY,
      process.env.AZURE_SPEECH_REGION,
    );
    this.speechConfig.speechRecognitionLanguage = 'zh-TW';
  }

  async recognizeFromFile(audioBuffer: Buffer): Promise<RecognitionResult> {
    const audioConfig = sdk.AudioConfig.fromWavFileInput(audioBuffer);
    const recognizer = new sdk.SpeechRecognizer(this.speechConfig, audioConfig);

    return new Promise((resolve, reject) => {
      recognizer.recognizeOnceAsync(
        (result) => {
          if (result.reason === sdk.ResultReason.RecognizedSpeech) {
            resolve({
              text: result.text,
              duration: result.duration / 10000000, // è½‰æ›ç‚ºç§’
              confidence: result.privProperties.getProperty('SpeechServiceResponse_JsonResult'),
            });
          } else {
            reject(new Error(`èªéŸ³è­˜åˆ¥å¤±æ•—: ${result.errorDetails}`));
          }
          recognizer.close();
        },
        (error) => {
          recognizer.close();
          reject(error);
        }
      );
    });
  }
}
```

---

## ğŸ“Š è³‡æ–™åº«è¨­è¨ˆ (å®Œæ•´ç‰ˆ)

### Schema

```sql
-- 1. å­¸æ ¡
CREATE TABLE schools (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  name VARCHAR(255) NOT NULL,
  email_domain VARCHAR(255) UNIQUE, -- e.g., "school.edu.tw"
  created_at TIMESTAMP DEFAULT NOW()
);

-- 2. æ•™å¸«
CREATE TABLE teachers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  school_id UUID REFERENCES schools(id),
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255) UNIQUE NOT NULL,
  auth_provider VARCHAR(50), -- 'google' | 'microsoft'
  created_at TIMESTAMP DEFAULT NOW()
);

-- 3. ç­ç´š
CREATE TABLE classrooms (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  teacher_id UUID REFERENCES teachers(id),
  name VARCHAR(100) NOT NULL,
  grade INTEGER, -- 1 | 2 | 3
  created_at TIMESTAMP DEFAULT NOW()
);

-- 4. å­¸ç”Ÿ
CREATE TABLE students (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  classroom_id UUID REFERENCES classrooms(id),
  name VARCHAR(100) NOT NULL,
  email VARCHAR(255),
  created_at TIMESTAMP DEFAULT NOW()
);

-- 5. èª²ç¨‹
CREATE TABLE lessons (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  title VARCHAR(255) NOT NULL,
  content TEXT,
  vocabulary JSONB, -- [{"char": "å‹•", "pinyin": "dÃ²ng", "def": "..."}]
  github_path VARCHAR(500),
  target_speed INTEGER DEFAULT 150, -- å­—/åˆ†
  target_accuracy INTEGER DEFAULT 90, -- %
  created_at TIMESTAMP DEFAULT NOW()
);

-- 6. èª²ç¨‹åˆ†é…
CREATE TABLE lesson_assignments (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  classroom_id UUID REFERENCES classrooms(id),
  lesson_id UUID REFERENCES lessons(id),
  assigned_at TIMESTAMP DEFAULT NOW()
);

-- 7. ä½œæ¥­æäº¤ (å« AI åˆ†æçµæœ) â­
CREATE TABLE submissions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  student_id UUID REFERENCES students(id),
  lesson_id UUID REFERENCES lessons(id),
  paragraph INTEGER, -- ç¬¬å¹¾æ®µ
  audio_url VARCHAR(500),

  -- AI åˆ†æçµæœ
  transcription TEXT, -- AI è½‰éŒ„æ–‡å­—
  original_text TEXT, -- åŸæ–‡
  speed_wpm INTEGER, -- èªé€Ÿ (å­—/åˆ†)
  accuracy_rate INTEGER, -- æ­£ç¢ºç‡ (%)
  duration_seconds FLOAT, -- æœ—è®€æ™‚é•· (ç§’)

  errors JSONB, -- éŒ¯èª¤æ¸…å–®
  suggestions JSONB, -- ç·´ç¿’å»ºè­°

  is_passed BOOLEAN DEFAULT false, -- æ˜¯å¦é”æ¨™

  created_at TIMESTAMP DEFAULT NOW()
);

-- 8. éŒ¯å­—è©è¨˜éŒ„ (ç”¨æ–¼ç”Ÿå­—å­¸ç¿’)
CREATE TABLE error_words (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  student_id UUID REFERENCES students(id),
  word VARCHAR(10) NOT NULL,
  error_count INTEGER DEFAULT 1,
  last_seen_at TIMESTAMP DEFAULT NOW()
);
```

---

## ğŸ¨ å‰ç«¯è¨­è¨ˆ (é—œéµé é¢)

### 1. å­¸ç”Ÿæœ—è®€é é¢ (æ ¸å¿ƒ)

```tsx
// app/lessons/[id]/page.tsx

'use client';

export default function LessonReadingPage({ params }: { params: { id: string } }) {
  const { data: lesson } = useQuery(['lesson', params.id], () =>
    api.lessons.get(params.id)
  );

  const [currentParagraph, setCurrentParagraph] = useState(1);
  const [showPinyin, setShowPinyin] = useState(true); // æ³¨éŸ³é¡¯ç¤º

  // Space éµåˆ‡æ›æ³¨éŸ³
  useEffect(() => {
    const handleKeyPress = (e: KeyboardEvent) => {
      if (e.code === 'Space' && !e.target.matches('input, textarea')) {
        e.preventDefault();
        setShowPinyin(prev => !prev);
      }
    };
    window.addEventListener('keydown', handleKeyPress);
    return () => window.removeEventListener('keydown', handleKeyPress);
  }, []);

  return (
    <div className="container max-w-4xl mx-auto p-8">
      <h1 className="text-3xl font-bold mb-4">{lesson?.title}</h1>

      {/* æ³¨éŸ³é–‹é—œæç¤º */}
      <div className="mb-4 text-sm text-gray-600">
        æŒ‰ <kbd className="px-2 py-1 bg-gray-200 rounded">Space</kbd> åˆ‡æ›æ³¨éŸ³ç¬¦è™Ÿ
      </div>

      {/* èª²æ–‡ (åˆ†æ®µé¡¯ç¤º) */}
      <div className="mb-8">
        {lesson?.paragraphs.map((para, idx) => {
          const isLocked = idx + 1 > currentParagraph;
          const isCurrent = idx + 1 === currentParagraph;

          return (
            <div
              key={idx}
              className={cn(
                'mb-6 p-4 rounded-lg',
                isCurrent && 'bg-blue-50 border-2 border-blue-300',
                isLocked && 'opacity-50 pointer-events-none'
              )}
            >
              <div className="text-2xl leading-relaxed">
                {showPinyin ? (
                  // é¡¯ç¤ºæ³¨éŸ³
                  <ruby>
                    {para.text.split('').map((char, i) => (
                      <React.Fragment key={i}>
                        <rb>{char}</rb>
                        <rp>(</rp>
                        <rt className="text-sm text-gray-500">{para.pinyin[i]}</rt>
                        <rp>)</rp>
                      </React.Fragment>
                    ))}
                  </ruby>
                ) : (
                  // éš±è—æ³¨éŸ³
                  para.text
                )}
              </div>

              {isCurrent && (
                <div className="mt-4">
                  <AudioRecorder
                    lessonId={params.id}
                    paragraph={idx + 1}
                    onAnalysisComplete={(result) => {
                      // é¡¯ç¤ºå…­å¤§ç’°ç¯€å›é¥‹
                      setFeedbackResult(result);

                      // å¦‚æœé”æ¨™,è§£é–ä¸‹ä¸€æ®µ
                      if (result.overview.isPassed) {
                        setCurrentParagraph(prev => prev + 1);
                      }
                    }}
                  />
                </div>
              )}

              {isLocked && (
                <div className="mt-2 text-gray-500">
                  ğŸ”’ å®Œæˆä¸Šä¸€æ®µå¾Œè§£é–
                </div>
              )}
            </div>
          );
        })}
      </div>

      {/* å…­å¤§ç’°ç¯€å›é¥‹ */}
      {feedbackResult && (
        <FeedbackPanel result={feedbackResult} />
      )}
    </div>
  );
}
```

### 2. å…­å¤§ç’°ç¯€å›é¥‹é¢æ¿

```tsx
// components/FeedbackPanel.tsx

export function FeedbackPanel({ result }: { result: FeedbackResult }) {
  const [activeTab, setActiveTab] = useState(0);

  const tabs = [
    { label: '1. çµæœç¸½è¦½', icon: 'ğŸ“Š' },
    { label: '2. éŒ„éŸ³æ’­æ”¾', icon: 'ğŸ¤' },
    { label: '3. é€å¥å°æ¯”', icon: 'ğŸ”' },
    { label: '4. éŒ¯å­—è©', icon: 'ğŸ“' },
    { label: '5. å»ºè­°', icon: 'ğŸ’¡' },
    { label: '6. AI åˆ†æ', icon: 'ğŸ¤–' },
  ];

  return (
    <div className="bg-white rounded-lg shadow-lg p-6">
      {/* Tab å°èˆª */}
      <div className="flex space-x-2 mb-6">
        {tabs.map((tab, idx) => (
          <button
            key={idx}
            onClick={() => setActiveTab(idx)}
            className={cn(
              'px-4 py-2 rounded-lg',
              activeTab === idx ? 'bg-blue-500 text-white' : 'bg-gray-100'
            )}
          >
            {tab.icon} {tab.label}
          </button>
        ))}
      </div>

      {/* 1. çµæœç¸½è¦½ */}
      {activeTab === 0 && (
        <div>
          <div className="grid grid-cols-3 gap-4 mb-6">
            <div className="text-center p-4 bg-blue-50 rounded">
              <div className="text-3xl font-bold">{result.overview.speed}</div>
              <div className="text-gray-600">å­—/åˆ†</div>
            </div>
            <div className="text-center p-4 bg-green-50 rounded">
              <div className="text-3xl font-bold">{result.overview.accuracy}%</div>
              <div className="text-gray-600">æ­£ç¢ºç‡</div>
            </div>
            <div className="text-center p-4 bg-purple-50 rounded">
              <div className="text-3xl">
                {result.overview.isPassed ? 'âœ…' : 'âŒ'}
              </div>
              <div className="text-gray-600">
                {result.overview.isPassed ? 'é”æ¨™' : 'æœªé”æ¨™'}
              </div>
            </div>
          </div>
        </div>
      )}

      {/* 2. éŒ„éŸ³æ’­æ”¾èˆ‡è½‰éŒ„ */}
      {activeTab === 1 && (
        <div>
          <audio src={result.recording.audioUrl} controls className="w-full mb-4" />
          <div className="bg-gray-50 p-4 rounded">
            <h3 className="font-semibold mb-2">AI è½‰éŒ„:</h3>
            <p className="text-lg">{result.recording.transcription}</p>
          </div>
        </div>
      )}

      {/* 3. é€å¥å°æ¯” */}
      {activeTab === 2 && (
        <div className="space-y-4">
          {result.sentenceComparison.map((sentence, idx) => (
            <div key={idx} className="border-l-4 border-blue-300 pl-4">
              <div className="mb-2">
                <span className="text-gray-600">åŸæ–‡:</span>
                <div className="text-lg">{sentence.original}</div>
              </div>
              <div>
                <span className="text-gray-600">å¯¦è®€:</span>
                <div className="text-lg">
                  {sentence.transcribed.split('').map((char, i) => {
                    const isError = sentence.errors?.includes(i);
                    return (
                      <span
                        key={i}
                        className={cn(
                          isError && 'text-red-500 font-bold underline'
                        )}
                      >
                        {char}
                      </span>
                    );
                  })}
                </div>
              </div>
            </div>
          ))}
        </div>
      )}

      {/* 4. éŒ¯å­—è©ç·´ç¿’æ¸…å–® */}
      {activeTab === 3 && (
        <div className="space-y-2">
          {result.errorWordsList.length === 0 ? (
            <div className="text-center text-green-600 text-xl">
              ğŸ‰ å¤ªæ£’äº†!æ²’æœ‰éŒ¯å­—!
            </div>
          ) : (
            result.errorWordsList.map((error, idx) => (
              <div
                key={idx}
                className="flex items-center justify-between p-3 bg-red-50 rounded"
              >
                <div className="flex items-center space-x-4">
                  <span className="text-3xl">{error.word}</span>
                  <div>
                    <div className="text-sm text-gray-600">
                      {error.type === 'omission' && 'âŒ è·³é'}
                      {error.type === 'substitution' && 'âŒ è®€éŒ¯'}
                      {error.type === 'insertion' && 'â• å¤šè®€'}
                    </div>
                  </div>
                </div>
                <button
                  onClick={() => playAudio(error.word)}
                  className="p-2 bg-blue-500 text-white rounded-full"
                >
                  ğŸ”Š è½æ­£ç¢ºç™¼éŸ³
                </button>
              </div>
            ))
          )}
        </div>
      )}

      {/* 5. ç·´ç¿’å»ºè­° */}
      {activeTab === 4 && (
        <div className="space-y-3">
          {result.suggestions.map((suggestion, idx) => (
            <div key={idx} className="p-4 bg-yellow-50 rounded-lg">
              <div className="flex items-start">
                <span className="text-2xl mr-3">ğŸ’¡</span>
                <div>
                  <h4 className="font-semibold mb-1">{suggestion.title}</h4>
                  <p>{suggestion.message}</p>
                </div>
              </div>
            </div>
          ))}
        </div>
      )}

      {/* 6. AI è©³ç´°åˆ†æ */}
      {activeTab === 5 && (
        <div className="prose max-w-none">
          <h3>è©³ç´°åˆ†æå ±å‘Š</h3>
          <p>{result.aiAnalysis}</p>
        </div>
      )}
    </div>
  );
}
```

---

## ğŸ“… 4 é€±é–‹ç™¼è¨ˆç•« (æ­£ç¢ºç‰ˆ)

### Week 1: å¾Œç«¯ + Azure Speech SDK æ•´åˆ

**ç›®æ¨™**: å®Œæˆ AI èªéŸ³åˆ†ææ ¸å¿ƒåŠŸèƒ½

- [ ] Day 1-2: è³‡æ–™åº« Schema å»ºç«‹
- [ ] Day 3-4: Azure Speech SDK æ•´åˆèˆ‡æ¸¬è©¦
  - éŒ„è£½ 10 æ®µåœ‹å°ç”Ÿæœ—è®€æ¸¬è©¦éŸ³æª”
  - æ¸¬è©¦ Azure zh-TW WER (ç›®æ¨™ < 10%)
  - å¦‚ä¸é”æ¨™,ç«‹å³åˆ‡æ› Google Chirp 3
- [ ] Day 5: æ–‡æœ¬æ¯”å°æ¼”ç®—æ³•å¯¦ä½œ
  - Levenshtein Distance
  - ä¸­æ–‡å­—å°é½Š
  - éŒ¯èª¤åˆ†é¡ (è·³å­—ã€åŠ å­—ã€è®€éŒ¯)

### Week 2: å‰ç«¯å­¸ç”Ÿç«¯ + éŒ„éŸ³çµ„ä»¶

**ç›®æ¨™**: å­¸ç”Ÿèƒ½éŒ„éŸ³ä¸¦çœ‹åˆ°å…­å¤§ç’°ç¯€å›é¥‹

- [ ] Day 1-2: èª²ç¨‹åˆ—è¡¨ + èª²ç¨‹å…§å®¹é é¢
- [ ] Day 3: æ³¨éŸ³ç¬¦è™Ÿé¡¯ç¤ºåˆ‡æ› (Space éµ)
- [ ] Day 4-5: AudioRecorder çµ„ä»¶
  - éŒ„éŸ³ UI
  - ä¸Šå‚³åˆ° Cloud Storage
  - å‘¼å« AI åˆ†æ API
- [ ] Day 5: FeedbackPanel çµ„ä»¶ (å…­å¤§ç’°ç¯€)

### Week 3: åˆ†æ®µæœ—è®€æµç¨‹ + æ•™å¸«ç«¯

**ç›®æ¨™**: å®Œæ•´å­¸ç¿’æµç¨‹ + æ•™å¸«æŸ¥çœ‹å ±å‘Š

- [ ] Day 1-2: åˆ†æ®µæœ—è®€æµç¨‹
  - æ®µè½è§£é–æ©Ÿåˆ¶
  - é”æ¨™åˆ¤å®š
  - é€²åº¦è¿½è¹¤
- [ ] Day 3-4: æ•™å¸«ç«¯é é¢
  - ç­ç´šçµ±è¨ˆå ±å‘Š
  - å€‹åˆ¥å­¸ç”Ÿå ±å‘Š
  - å­¸ç¿’æ›²ç·šåœ–
- [ ] Day 5: GitHub èª²ç¨‹åŒæ­¥æœå‹™

### Week 4: æ¸¬è©¦ + éƒ¨ç½² + ä¿® Bug

**ç›®æ¨™**: ä¸Šç·šåˆ° GCP,çœŸå¯¦ä½¿ç”¨è€…æ¸¬è©¦

- [ ] Day 1-2: E2E æ¸¬è©¦ (Playwright)
  - å­¸ç”Ÿå®Œæ•´æµç¨‹
  - AI åˆ†ææº–ç¢ºæ€§é©—è­‰
- [ ] Day 3: GCP éƒ¨ç½²
  - Cloud Run
  - Cloud SQL
  - Cloud Storage
- [ ] Day 4-5: çœŸå¯¦ä½¿ç”¨è€…æ¸¬è©¦ + ä¿® Bug
  - è‡³å°‘ 2-3 ä½åœ‹å°å­¸ç”Ÿæ¸¬è©¦
  - æ”¶é›†å›é¥‹ä¸¦æ”¹é€²

---

## ğŸ’° æˆæœ¬ä¼°ç®— (æ­£ç¢ºç‰ˆ)

### Azure Speech SDK æˆæœ¬

| é …ç›® | è¦æ ¼ | æœˆæˆæœ¬ (50 å­¸ç”Ÿ) | æœˆæˆæœ¬ (500 å­¸ç”Ÿ) |
|------|------|-----------------|------------------|
| Azure Speech STT | $1/å°æ™‚ | $250 | $2,500 |
| Cloud Run | 100 è¬æ¬¡è«‹æ±‚ | $0 (å…è²») | $10 |
| Cloud SQL | db-f1-micro | $7 | $70 |
| Cloud Storage | 5 GB â†’ 50 GB | $0.10 | $1 |
| Firebase Hosting | 10 GB | $0 (å…è²») | $0 (å…è²») |
| **ç¸½è¨ˆ** | - | **~$257/æœˆ** | **~$2,581/æœˆ** |

**é‡è¦ç™¼ç¾**: Azure Speech SDK æ˜¯æœ€å¤§æˆæœ¬é …!

### æˆæœ¬å„ªåŒ–æ–¹æ¡ˆ

#### æ–¹æ¡ˆ A: ä½¿ç”¨ Azure å…è²»é¡åº¦

- Azure æä¾›æ¯æœˆ 5 å°æ™‚å…è²» STT
- 50 å­¸ç”Ÿæ¯æœˆ ~250 å°æ™‚ â†’ è¶…å‡ºå¾ˆå¤š
- âŒ ä¸é©ç”¨

#### æ–¹æ¡ˆ B: åˆ‡æ›åˆ° OpenAI Whisper (è‡ªå»º)

- æˆæœ¬: GCP Compute Engine (g2-standard-4 with GPU)
- æœˆæˆæœ¬: ~$300 (æ¯” Azure $250 è²´,ä½†ç„¡ç”¨é‡é™åˆ¶)
- âœ… é©åˆé«˜ä½¿ç”¨é‡å ´æ™¯

#### æ–¹æ¡ˆ C: Hybrid æ··åˆæ¨¡å¼

- å³æ™‚å›é¥‹: Azure Speech SDK (å¿«é€Ÿ,< 5 ç§’)
- æ‰¹æ¬¡åˆ†æ: Whisper (æ…¢,ä½†å…è²»)
- æœˆæˆæœ¬: ~$150
- âœ… æœ€ä½³å¹³è¡¡

**å»ºè­°**: MVP éšæ®µå…ˆç”¨ Azure (å¿«é€Ÿé©—è­‰),V2 å†è€ƒæ…® Whisper é™æˆæœ¬ã€‚

---

## âœ… MVP å®Œæˆå®šç¾© (æ­£ç¢ºç‰ˆ)

ç•¶ä»¥ä¸‹å…¨éƒ¨é”æˆ,MVP å°±ç®—å®Œæˆ:

- [ ] **AI èªéŸ³åˆ†ææº–ç¢ºç‡ > 90%** (Azure zh-TW WER < 10%)
- [ ] **å³æ™‚å›é¥‹ < 5 ç§’** (å¾éŒ„éŸ³çµæŸåˆ°é¡¯ç¤ºçµæœ)
- [ ] **å…­å¤§ç’°ç¯€å®Œæ•´å‘ˆç¾** (ç¸½è¦½ã€éŒ„éŸ³ã€å°æ¯”ã€éŒ¯å­—è©ã€å»ºè­°ã€åˆ†æ)
- [ ] **åˆ†æ®µæœ—è®€æµç¨‹å¯é‹ä½œ** (æ®µè½è§£é–ã€é”æ¨™åˆ¤å®š)
- [ ] **æ³¨éŸ³ç¬¦è™Ÿåˆ‡æ›æ­£å¸¸** (Space éµ)
- [ ] **æ•™å¸«èƒ½æŸ¥çœ‹ç­ç´šå ±å‘Š**
- [ ] **è‡³å°‘ 2-3 ä½åœ‹å°å­¸ç”Ÿæ¸¬è©¦é€šé**
- [ ] **æ›¾ä¸–æ°æ•™æˆç¢ºèªç¬¦åˆé–±è®€ç§‘å­¸åŸç†** â­

---

## ğŸš¨ é—œéµé¢¨éšªèˆ‡æ‡‰å°

| é¢¨éšª | å½±éŸ¿ | æ‡‰å° |
|------|------|------|
| **Azure zh-TW WER > 10%** | **é«˜** | Week 1 ç«‹å³æ¸¬è©¦,ä¸é”æ¨™åˆ‡æ› Google Chirp 3 |
| **Azure æˆæœ¬è¶…æ”¯** | ä¸­ | è¨­å®šé ç®—å‘Šè­¦,æº–å‚™ Whisper å‚™æ¡ˆ |
| **ä¸­æ–‡å­—å°é½Šæ¼”ç®—æ³•ä¸æº–** | é«˜ | åƒè€ƒæ–¹å¤§å“¥ Flutter App å¯¦ä½œ |
| **åœ‹å°ç”ŸéŒ„éŸ³å“è³ªå·®** | ä¸­ | å‰ç«¯åŠ éŸ³é‡æª¢æ¸¬,æç¤ºé‡éŒ„ |
| **æ›¾æ•™æˆé©—è­‰ä¸é€šé** | **é«˜** | Week 2/8/14 å®šæœŸ Demo,åŠæ—©èª¿æ•´ |

---

## ğŸ“š åƒè€ƒè³‡æ–™

### æ•™å­¸ç†è«–

- [PRD.md](../docs/PRD.md) - å®Œæ•´ç”¢å“éœ€æ±‚æ–‡ä»¶
- æ›¾ä¸–æ°æ•™æˆæ•™å­¸æ–¹æ³• (PRD ç¬¬ 56-143 è¡Œ)
- é–±è®€æ–¹ç¨‹å¼: è­˜å­—è§£ç¢¼ Ã— èƒŒæ™¯çŸ¥è­˜

### æŠ€è¡“åƒè€ƒ

- [æ–¹å¤§å“¥ Flutter App](https://github.com/Shinjou/learning-to-read-chinese) - 9,606 å­—ç­†é †è³‡æ–™
- [Azure Speech SDK ç¹é«”ä¸­æ–‡ç ”ç©¶](../docs/references/azure-speech-sdk-zh-tw-research.md)
- [æ•™è‚²è³‡æºæ¸…å–®](../docs/EDUCATIONAL_RESOURCES.md)

### æˆæœ¬èˆ‡æ•ˆèƒ½

- Azure Speech SDK: $1/å°æ™‚
- Google Chirp 3: $2.40/å°æ™‚ (æ¯” Azure è²´ 140%)
- OpenAI Whisper: WER 10.3% (è¿¦ç´å­¸ç”Ÿç ”ç©¶)

---

**Generated with [Claude Code](https://claude.ai/code) via [Happy](https://happy.engineering)**

Co-Authored-By: Claude <noreply@anthropic.com>
Co-Authored-By: Happy <yesreply@happy.engineering>
